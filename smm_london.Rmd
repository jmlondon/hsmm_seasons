---
output:
  revealjs::revealjs_presentation:
    fig_width: 8
    fig_height: 6
---

```{r pkgs,include=FALSE}
library(ggplot2)
library(dplyr)
library(lubridate)
library(nPacMaps)
library(sp)
library(rgdal)
library(uswebr)
```

```{r color-pal, include=FALSE}
library(scales)
cblind_main <- c(blue="#0072B2",
                vermillion="#D55E00",
                bluish_green="#009E73",
                reddish_purple="#CC79A7",
                orange="#E69F00")

cblind_pal <- function() {
  manual_pal(unname(cblind_main))
}

scale_colour_cblind <- function(...) {
  discrete_scale("colour", "cblind", cblind_pal(), ...)
}

scale_color_cblind <- scale_colour_cblind

scale_fill_cblind <- function(...) {
  discrete_scale("fill", "cblind", cblind_pal(), ...)
} 
```

Estimating Seasonal Behavior States from Biologging Sensor Data
========================================================
Josh M. London<br />
Devin S. Johnson, Paul B. Conn, Brett T. McClintock, Michael F. Cameron, and Peter L. Boveng
<p />
<small>Alaska Fisheries Science Center, NOAA Fisheries
Seattle, Washington, USA</small>
<p />
14 December 2015

The Importance of Seasons
========================================================

> The seasonal timing of key, annual life history events is an important component of many species' ecology.

- Bird migrations coincide with availability of food en route
- Salmon spawning timed with favorable water flow
- Arctic ice seals linked with seasonal sea-ice

It's All About the Timing
========================================================

> The timing of key life history events is well documented only for species found in accessible rookeries, breeding areas, or migratory corridors.

- Pinniped rookery counts: first territory, first pup
- Migration Timing: Eastern grey whales
- Elephant seal molt season

Remote, Widely Disperssed Species a Challenge
========================================================

> Our knowledge of seasonal timing for species widely dispersed in inaccessible or remote habitats is poor. We only get a snapshot

- Rare or irregular snapshots
- e.g. a single aerial survey or rookery count

The Importance of Seasons
========================================================

> Seasonal periods important to marine mammals often do not align well with typical labels (i.e., spring, summer, winter, fall).

- How can we identify species specific seasons?

Data from Biologgers
========================================================

Could we use observations from bio-logging sensors to estimate seasons?

- Fine-scale observations
- Deployment lengths of several months, approaching 1 year
- Records of both movement and behavior

Hidden Markov Models
========================================================

- Useful for pattern recognition in noisy time series data
- Previously used with telemetry data to identify behavioral states
- Behavioral states are, typically, shorter time frames
- Duration in a state is not dependent on time already spent in a state

Multivariate Semi-Hidden Markov Models
=========================================================

Multivariate Semi-Hidden Markov Models
=========================================================

> Hidden semi-Markov models allow an arbitrary sojourn distribution

R package `mshmm` 

Regularly Spaced Observations
=========================================================

- Argos/GPS-fastloc locations are irregular in time
- Use movement model to predict regularly-spaced observations

R Package `crawl` --- Continuous Time Correlated Random Walk

Predict locations 6-hourly to align with behavioral observations

Bearded, Ribbon and Spotted Seals
=======================================================



Predicted Movements
========================================================

```{r load-pred-data,echo=FALSE,warning=FALSE,message=FALSE,cache=TRUE}
load('predData.rda')
load('dd_ribbon.rda')
load('dd_bearded.rda')
load('dd_spotted_yoy.rda')

data(alaska_dcw)
data(russia_dcw)
data(canada_dcw)

ak<-spTransform(alaska_dcw,CRS("+init=epsg:3571"))
rus<-spTransform(russia_dcw,CRS("+init=epsg:3571"))
can<-spTransform(canada_dcw,CRS("+init=epsg:3571"))

ak<-fortifi(ak,tol=1000,minarea=1000000)
rus<-fortifi(rus,tol=1000,minarea=1000000)
can<-fortifi(can,tol=1000,minarea=1000000)

xlim<-range(predData$mu.x)
ylim<-range(predData$mu.y)

p <- ggplot() + 
  geom_polygon(data=ak, aes(x=long, y=lat, group = group, id=id),fill="grey60" ) + 
  geom_polygon(data=rus, aes(x=long, y=lat, group = group, id=id),fill="grey60" ) + 
  geom_polygon(data=can, aes(x=long, y=lat, group = group, id=id),fill="grey60",colour="grey60" ) +
  geom_point(data=predData,aes(x=mu.x,y=mu.y,colour=species),
             size=0.65,alpha=0.3) +
  coord_fixed(xlim=xlim*1.1, ylim=ylim) + 
  scale_x_continuous(labels=to_km()) + 
  scale_y_continuous(labels=to_km()) +
  xlab("easting (km)") + ylab("northing (km)") +
  uswebr::usweb_theme() + scale_color_cblind() +
  ggtitle("Predicted Movements of Bearded, Ribbon, and Spotted Seals\nin the Bering Sea and North Pacific") + facet_wrap(~species,nrow=1) +
  theme(axis.text.y = element_blank())
p
ggsave("pres_data/fig-1.png",dpi=192)
```

Haul-out Behavior - Bearded Seals
=================================================
```{r eb-haulout, echo=FALSE,warning=FALSE,message=FALSE}
predData_eb <- predData %>% filter(species=="Bearded seal")
p <- ggplot(predData_eb, aes(x=days_since_apr1, y=factor(ho_binary))) + 
  geom_point(aes(colour=factor(ho_binary)),alpha=0.8,size=3,shape=3) + 
  facet_wrap(~deployid,ncol=1) + 
  ggtitle("haul-out status (bearded seal)") +
  usweb_theme() + scale_color_cblind() +
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank()) +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
  ylab("haul-out status") + xlab("time since 01 April")
p
ggsave("pres_data/fig-2.png",dpi=192)
p <- p + theme(plot.title = element_blank())
ggsave("pres_data/fig-2a.png",plot=p,dpi=192,width=3, height=6,units="in")
```

Haul-out Behavior - Ribbon Seals
=================================================
```{r hf-haulout, echo=FALSE,warning=FALSE,message=FALSE}
samp <- predData %>% filter(species=="Ribbon seal") %>% group_by(deployid,species) %>% summarize(n=n()) %>% ungroup() %>% sample_n(8) %>% select(deployid)
p <- predData %>% filter(deployid %in% samp$deployid) %>% 
ggplot(aes(x=days_since_apr1, y=factor(ho_binary))) + 
  geom_point(aes(colour=factor(ho_binary)),alpha=0.8,size=3,shape=3) + 
  facet_wrap(~deployid,ncol=1) + 
  ggtitle("haul-out status (ribbon seal)") +
  usweb_theme() + scale_color_cblind() +
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank()) +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
  ylab("haul-out status") + xlab("time since 01 April")
p
ggsave("pres_data/fig-3.png",dpi=192)
```

Haul-out Behavior - Spotted Seals
=================================================
```{r pl-haulout, echo=FALSE,warning=FALSE,message=FALSE}
samp <- predData %>% filter(species=="Spotted seal") %>% group_by(deployid,species) %>% summarize(n=n()) %>% ungroup() %>% sample_n(8) %>% select(deployid)
p <- predData %>% filter(deployid %in% samp$deployid) %>% 
ggplot(aes(x=days_since_apr1, y=factor(ho_binary))) + 
  geom_point(aes(colour=factor(ho_binary)),alpha=0.8,size=3,shape=3) + 
  facet_wrap(~deployid,ncol=1) + 
  ggtitle("haul-out status (spotted seal)") +
  usweb_theme() + scale_color_cblind() +
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank()) +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
  ylab("haul-out status") + xlab("time since 01 April")
p
ggsave("pres_data/fig-4.png",dpi=192)
```

Dive Behavior - Bearded Seals
=================================================
```{r eb-dives, echo=FALSE,warning=FALSE,message=FALSE}
predData_eb <- predData %>% filter(species=="Bearded seal")
p <- ggplot(predData_eb, aes(x=days_since_apr1, y=num_dives)) + 
  geom_point(alpha=0.2,size=2.5,color=cblind_main["blue"]) + facet_wrap(~deployid,ncol=1) + 
  ggtitle("Number of Dives per 6 Hours (bearded seal)") +
  usweb_theme() +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
  ylab("number of dives") + xlab("time since 01 April")
p
ggsave("pres_data/fig-5.png",dpi=192)
p <- p + theme(plot.title = element_blank())
ggsave("pres_data/fig-5a.png",plot=p,dpi=192,width=3, height=6,units="in")
```

Dive Behavior - Ribbon Seals
=================================================
```{r hf-dives, echo=FALSE,warning=FALSE,message=FALSE}
samp <- predData %>% filter(species=="Ribbon seal") %>% group_by(deployid,species) %>% summarize(n=n()) %>% ungroup() %>% sample_n(8) %>% select(deployid)
p <- predData %>% filter(deployid %in% samp$deployid) %>% 
ggplot(aes(x=days_since_apr1, y=num_dives)) + 
  geom_point(alpha=0.2,size=2.5,color="#112e51") + facet_wrap(~deployid,ncol=1) + 
  ggtitle("Number of Dives per 6 Hours (ribbon seal)") +
  usweb_theme()+
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
  ylab("number of dives") + xlab("time since 01 April")
p
ggsave("pres_data/fig-6.png",dpi=192)
```

Dive Behavior - Spotted Seals
=================================================
```{r pl-dives, echo=FALSE,warning=FALSE,message=FALSE}
samp <- predData %>% filter(species=="Spotted seal") %>% group_by(deployid,species) %>% summarize(n=n()) %>% ungroup() %>% sample_n(8) %>% select(deployid)
p <- predData %>% filter(deployid %in% samp$deployid) %>% 
ggplot(aes(x=days_since_apr1, y=num_dives)) + 
  geom_point(alpha=0.2,size=2.5,color="#112e51") + facet_wrap(~deployid,ncol=1) + 
  ggtitle("Number of Dives per 6 Hours (spotted seal)") +
  usweb_theme()+
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
  ylab("number of dives") + xlab("time since 01 April")
p
ggsave("pres_data/fig-7.png",dpi=192)
```

X-Y Displacement - Bearded Seals
=================================================
```{r y-disp-eb,echo=FALSE,warning=FALSE,message=FALSE}
p <- predData_eb %>% mutate(direction = ifelse(
  y_disp >= 0, "north","south")) %>% 

ggplot(aes(x=days_since_apr1, y=y_disp/1000)) +
  geom_bar(aes(color=factor(direction)),alpha=0.2,stat="identity") +
  facet_wrap(~deployid,ncol=1) + 
  ggtitle("y displacement (bearded seal)") +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
  ylab("y displacement") + xlab("time since 01 April") +
  usweb_theme() + scale_color_cblind() 

ggsave("pres_data/fig-8.png",dpi=192)
p <- p + theme(plot.title = element_blank())
ggsave("pres_data/fig-8a.png",plot=p,dpi=192,width=3, height=6,units="in")
```

X-Y Displacement - Bearded Seals
=================================================
```{r x-disp-eb,echo=FALSE,warning=FALSE,message=FALSE}
predData_eb %>% mutate(direction = ifelse(
  x_disp >= 0, "west","east")) %>% 

ggplot(aes(x=days_since_apr1, y=x_disp/1000)) +
  geom_bar(aes(color=factor(direction)),alpha=0.2,stat="identity") +
  facet_wrap(~deployid,ncol=1) + 
  ggtitle("x displacement (bearded seal)") +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
  ylab("x displacement") + xlab("time since 01 April") +
  usweb_theme() + scale_color_cblind() 
ggsave("pres_data/fig-9.png",dpi=192)
```

Seasonal States - Bearded Seals
==================================================
```{r eb-states-indiv,echo=FALSE,warning=FALSE,message=FALSE}
load('dd_bearded.rda')
ggplot(data=dd_bearded,aes(x=days_since_apr1,y="state")) + 
  geom_tile(aes(fill=state)) + 
  facet_wrap(~deployid, ncol=1) + 
  usweb_theme()+ scale_fill_cblind() +
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  ggtitle("Seasonal State Assignments - Bearded Seals") +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
ggsave("pres_data/fig-10.png",dpi=192)
```

Seasonal States - Bearded Seals
===================================================
```{r eb-states-combo, echo=FALSE,warning=FALSE,message=FALSE}
combo <- dd_bearded %>% 
  group_by(days_since_apr1,state) %>% 
  summarise(counter = n()) %>% 
  group_by(days_since_apr1) %>% 
  filter(counter == max(counter))

p <- ggplot(data=combo,aes(x=days_since_apr1,y=" ")) + 
  geom_tile(aes(fill=state)) +
  scale_fill_discrete(limits=levels(dd_bearded$state),drop=TRUE) +
  scale_alpha(guide = 'none') + usweb_theme() +
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  ggtitle("Majority Seasonal State Assignments - Bearded Seals") + scale_fill_cblind() +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
ggsave("pres_data/fig-11.png",plot=p, dpi=192)

p <- ggplot(data=combo,aes(x=days_since_apr1,y=" ")) + 
  geom_tile(aes(fill=state,alpha=counter/7)) +
  scale_fill_discrete(limits=levels(dd_bearded$state),drop=TRUE) +
  scale_alpha(guide = 'none') + usweb_theme() +
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank())+
  ggtitle("Majority Seasonal State Assignments - Bearded Seals") + scale_fill_cblind() +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
p
ggsave("pres_data/fig-11b.png",dpi=192)
p <- p + theme(plot.title = element_blank())
p
ggsave("pres_data/fig-11a.png",width=8,height=2,units="in")
```

% Dry x Seasonal States
=================================================
```{r eb-percent-states, echo=FALSE,warning=FALSE, message=FALSE}
ggplot(data=dd_bearded %>% filter(percent_dry>3),aes(x=percent_dry)) +
  geom_density(aes(fill=state),size=0) + facet_wrap(~state) +
  ggtitle("Distribution of Percent Dry Across Seasonal States") +
  usweb_theme() + scale_fill_cblind()
ggsave("pres_data/fig-12.png",dpi=192,width=8,height=4,units="in")
```

No. of Dives x Seasonal States
=================================================
```{r eb-dives-states, echo=FALSE,warning=FALSE,message=FALSE}
ggplot(data=dd_bearded %>% filter(num_dives<150),aes(x=num_dives)) +
  geom_density(aes(fill=state),size=0) + facet_wrap(~state) +
  ggtitle("Distribution of Number of Dives Across Seasonal States") +
  usweb_theme()  + scale_fill_cblind()
ggsave("pres_data/fig-13.png",dpi=192,width=8,height=4,units="in")
```

Bearing x Seasonal States
=================================================
```{r eb-compass-states, echo=FALSE, warning=FALSE, message=FALSE, fig.width=9}
ggplot(data=dd_bearded) +
  geom_histogram(aes(x=bearing,y=..density..,fill=state),binwidth=12) +
  coord_polar() + 
  scale_x_continuous(limits=c(0,360),breaks=seq(0,359, by=45)) +
  facet_wrap(~state,nrow=1) +
  ggtitle(paste("Distribution of Movement and \n",
                "Compass Bearing Across Seasonal States")) + 
  usweb_theme()  + scale_fill_cblind()
ggsave("pres_data/fig-14.png",dpi=192)
```

Spatial Distribution of Seasonal States
=================================================
```{r eb-spatial-states, echo=FALSE,warning=FALSE,message=FALSE}
xlim<-range(dd_bearded$mu.x)
ylim<-range(dd_bearded$mu.y)

p <- ggplot() + 
  geom_polygon(data=ak, aes(x=long, y=lat, group = group, id=id),fill="grey60" ) + 
  geom_polygon(data=rus, aes(x=long, y=lat, group = group, id=id),fill="grey60" ) + 
  geom_polygon(data=can, aes(x=long, y=lat, group = group, id=id),fill="grey60",colour="grey60" ) +
  geom_point(data=dd_bearded,aes(x=mu.x,y=mu.y,colour=state),size=1.75,alpha=0.4) +
  coord_fixed(xlim=xlim*1.1, ylim=ylim) + 
  scale_x_continuous(labels=to_km()) + 
  scale_y_continuous(labels=to_km()) + facet_wrap(~state,nrow=1) +
  xlab("easting (km)") + ylab("northing (km)") +
  uswebr::usweb_theme() + theme(axis.text.y=element_text(angle=90)) +
  ggtitle("Predicted Movements of Bearded Seals \n by Assigned Seasonal State")  + scale_color_cblind()
p
ggsave("pres_data/fig-15.png",dpi=192)
```

Seasonal States - Ribbon Seals
==================================================
```{r hf-states-indiv,echo=FALSE,warning=FALSE,message=FALSE}

samp <- dd_ribbon %>% filter(species=="Ribbon seal") %>% group_by(deployid,species) %>% summarize(n=n()) %>% ungroup() %>% sample_n(8) %>% select(deployid)
p <- dd_ribbon %>% filter(deployid %in% samp$deployid) %>% 
ggplot(aes(x=days_since_apr1,y="state")) + 
  geom_tile(aes(fill=state)) + 
  facet_wrap(~deployid, ncol=1) + 
  usweb_theme()+ scale_fill_cblind() +
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  ggtitle("Seasonal State Assignments - Ribbon Seals (sample)") +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
p
ggsave("pres_data/fig-20.png",dpi=192,width=8, height=4,units="in")
```

Seasonal States - Ribbon Seals
===================================================
```{r hf-states-combo, echo=FALSE,warning=FALSE,message=FALSE}
combo <- dd_ribbon %>% 
  group_by(days_since_apr1,state) %>% 
  summarise(counter = n()) %>% 
  group_by(days_since_apr1) %>% 
  filter(counter == max(counter))

p <- ggplot(data=combo,aes(x=days_since_apr1,y=" ")) + 
  geom_tile(aes(fill=state)) +
  scale_fill_discrete(limits=levels(dd_ribbon$state),drop=TRUE) +
  scale_alpha(guide = 'none') + usweb_theme()+
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  ggtitle("Majority Seasonal State Assignments - Ribbon Seals") + scale_fill_cblind() +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
ggsave("pres_data/fig-18.png",plot=p, dpi=192)

p <- ggplot(data=combo,aes(x=days_since_apr1,y=" ")) + 
  geom_tile(aes(fill=state,alpha=counter/7)) +
  scale_fill_discrete(limits=levels(dd_ribbon$state),drop=TRUE) +
  scale_alpha(guide = 'none') + usweb_theme()+
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  ggtitle("Majority Seasonal State Assignments - Ribbon Seals") + scale_fill_cblind() +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
p
ggsave("pres_data/fig-18b.png",dpi=192)
p <- theme(plot.title = element_blank())
p
ggsave("pres_data/fig-18a.png",width=8,height=2,units="in")
```

Seasonal States - Ribbon
==================================================
```{r pl-states-indiv,echo=FALSE,warning=FALSE,message=FALSE}

samp <- dd_spotted_yoy %>% filter(species=="Spotted seal") %>% group_by(deployid,species) %>% summarize(n=n()) %>% ungroup() %>% sample_n(8) %>% select(deployid)
p <- dd_spotted_yoy %>% filter(deployid %in% samp$deployid) %>% 
ggplot(aes(x=days_since_apr1,y="state")) + 
  geom_tile(aes(fill=state)) + 
  facet_wrap(~deployid, ncol=1) + 
  usweb_theme()+ scale_fill_cblind() +
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  ggtitle("Seasonal State Assignments - Young Spotted Seals (sample)") +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
p
ggsave("pres_data/fig-21.png",dpi=192,width=8, height=4,units="in")
```

Seasonal States - Spotted Seals (Young of Year)
===================================================
```{r pl-states-combo, echo=FALSE,warning=FALSE,message=FALSE}
combo <- dd_spotted_yoy %>% 
  group_by(days_since_apr1,state) %>% 
  summarise(counter = n()) %>% 
  group_by(days_since_apr1) %>% 
  filter(counter == max(counter))

p <- ggplot(data=combo,aes(x=days_since_apr1,y=" ")) + 
  geom_tile(aes(fill=state)) +
  scale_fill_discrete(limits=levels(dd_spotted_yoy$state),drop=TRUE) +
  scale_alpha(guide = 'none') + usweb_theme()+
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  ggtitle("Majority Seasonal State Assignments - Young Spotted Seals") + scale_fill_cblind() +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
ggsave("pres_data/fig-19.png",plot=p, dpi=192)

p <- ggplot(data=combo,aes(x=days_since_apr1,y=" ")) + 
  geom_tile(aes(fill=state,alpha=counter/7)) +
  scale_fill_discrete(limits=levels(dd_spotted_yoy$state),drop=TRUE) +
  scale_alpha(guide = 'none') + usweb_theme()+
   theme(axis.text.y = element_blank(),
        axis.ticks.y = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
  ggtitle("Majority Seasonal State Assignments - Young Spotted Seals") + scale_fill_cblind() +
  scale_x_continuous(breaks=c(91,197,306),
                     labels=c("01 July","15 Oct","01 Feb")) +
   xlab("time since 01 April")
p
ggsave("pres_data/fig-19b.png",dpi=192)
p <- theme(plot.title = element_blank())
p
ggsave("pres_data/fig-19a.png",width=8,height=2,units="in")
```


